---
name: code-review-principles
description: コードレビューの普遍的原則。全プラットフォーム・全言語共通で適用される考え方。
---

# コードレビュー原則（普遍原則）

効果的なコードレビューの考え方と実践方法。

---

## レビューの目的

1. **品質向上**: バグ・設計問題の早期発見
2. **知識共有**: チーム内でのノウハウ伝達
3. **一貫性**: コードベース全体の統一感
4. **教育**: レビュイー・レビュアー双方の成長

---

## レビュー観点チェックリスト

### 1. 正確性（Correctness）
- [ ] 要件を満たしているか
- [ ] エッジケースを考慮しているか
- [ ] エラーハンドリングは適切か

### 2. 可読性（Readability）
- [ ] 意図が明確に伝わるか
- [ ] 命名は適切か
- [ ] コメントは必要十分か

### 3. 保守性（Maintainability）
- [ ] 変更が容易な構造か
- [ ] 重複はないか
- [ ] 責務は適切に分離されているか

### 4. テスト（Testing）
- [ ] テストは十分か
- [ ] テストが意図を表現しているか

### 5. セキュリティ（Security）
- [ ] 入力検証はあるか
- [ ] 機密情報の扱いは適切か
- [ ] 認証・認可は正しいか

### 6. パフォーマンス（Performance）
- [ ] 明らかな性能問題はないか
- [ ] N+1問題などはないか

---

## レビューコメントの書き方

### 良いコメント

```
// 具体的で建設的
この関数は複雑になっています。
extractValidation() と processData() に分割すると
責務が明確になり、テストも書きやすくなります。
```

### 避けるべきコメント

```
// 抽象的で非建設的
❌ 「これはよくない」
❌ 「なんでこう書いたの？」
❌ 「普通はこうしない」
```

---

## コメントの分類

| タグ | 意味 | 対応 |
|------|------|------|
| `[must]` | 必須修正 | マージ前に対応必須 |
| `[should]` | 推奨 | 対応推奨、理由あればスキップ可 |
| `[nit]` | 些細な指摘 | 対応任意 |
| `[question]` | 質問 | 回答必須 |
| `[praise]` | 賞賛 | そのまま |

---

## レビュイーの心得

1. **防御的にならない**: 指摘はコードへのフィードバック
2. **質問は歓迎**: 不明点は積極的に質問
3. **感謝を忘れずに**: レビュアーの時間に感謝

## レビュアーの心得

1. **敬意を持つ**: 人ではなくコードをレビュー
2. **建設的に**: 問題だけでなく解決策も提示
3. **良い点も指摘**: ポジティブフィードバックも重要

---

## レビューのスコープ

| サイズ | 目安 | レビュー時間 |
|-------|------|-------------|
| 小 | ~200行 | 15-30分 |
| 中 | 200-500行 | 30-60分 |
| 大 | 500行~ | 分割を検討 |

> **注意:** 大きなPRは分割を検討する

---

## 自動化すべきこと

以下は自動化し、人間のレビューから除外:
- コードフォーマット（Prettier、dartfmt等）
- 静的解析（ESLint、flutter analyze等）
- 型チェック（TypeScript、Dart等）
- テスト実行

人間は設計・ロジック・可読性に集中する。
